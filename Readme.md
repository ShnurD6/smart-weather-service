# Умный сервис прогноза погоды
**Средний уровень сложности**

- Для работы сервиса используется язык программирования C++
- Сервис написан с архитектурой клиент-сервер, поэтому клиентом может быть что угодно. Пока, для простоты, реализован только консольный клиентский интерфейс, но в планах прикрутить Telegram
- Интерфейс "сервера":
    - Получение ответа по координатам
    - Получаение ответа по названию города
- "Клиентом" может быть любой код, но для использования поиска по городу, необходимо реализовать callback выбора городов из списка.  
- Формат ответа - текст. Данные, полученные из API (температура и её ощущение) подставляются в текстовый шаблон. В итоге, в зависимости от данных, получается что-то вроде 

`Ваш прогноз погоды ☄:`

`Сейчас температура составляет -8℃, но ощущается как -3℃`

- Всё, кроме [JsonParser](https://github.com/nlohmann/json "Тут ссылка на использованный мной модуль для парсига JSON"), написано мной в рамках работы над этим проктом

---
Процесс работы "сервера" (далее -- ядро):
- Данные (координаты или название города) от пользователя передаются клиентом в ядро.
- Если это название города: 
    - Запрос сначала улетает в на апи https://opencagedata.com/, которое возращает список городов, которые удалось найти.
    - Далее, вызывается callback у клиента (он должен реализовывать интерфейс принятия массива найденных городов и ответа номером города), где решается, какой город из списка выбрать.
    - После принятия клиентом решения о выборе города - необходимые координаты перенаправляются в выдачу ответа ядра по координатам (ниже) 
- Если это координаты, или у нас уже есть координаты из предыдущего шага:
    - Отправляем их на апи http://openweathermap.org, оно говорит нам данные о погоде
    - Погоду используем для формирования ответа (процесс формирования описан выше)

---
Как это скомпилировать:
1. Программа написана на C++ с использованием стандарта C++17. Соотвественно, необходим компилятор, поддерживающий данный стандарт. Лучше всех справляется [clang](https://ps-group.github.io/compilers/llvm_setup).
2. Помимо этого, для работы с сокетами используется библиотека boost, её тоже необходимо [установить](https://www.boost.org/users/download/).
3. Для сборки используется система автоматизации CMake. Тоже придётся [поставить](https://cmake.org/download/)) 
4. Далее, в папке с проектом необходимо выполнить команду `cmake .`
5. Затем, нужно выполить `make -j4`
6. Готово! Вы восхотительны!

Как это запустить: 
1. Добавить ключ API для сервиса http://api.openweathermap.org в файл Weathertoken.api в корень проекта
2. Добавить ключ API для сервиса http://api.opencagedata.com/ в файл Citiestoken.api в корень проекта
3. `./SmartWeatherService`

_p.s. Если нужны токены -- напишите в телеграм @shnurd6, я скину)_