# Умный сервис прогноза погоды
**Средний уровень сложности**

- Для работы сервиса используется язык программирования C++
- Сервис написан с архитектурой клиент-сервер, поэтому клиентом может быть что угодно. Пока, для простоты, реализован только консольный клиентский интерфейс, но в планах прикрутить Telegram
- Интерфейс "сервера":
    - Получение ответа по координатам
    - Получаение ответа по названию города
- "Клиентом" может быть любой код, но для использования поиска по городу, необходимо реализовать callback выбора городов из списка.  
- Формат ответа - текст. Данные, полученные из API (температура, её ощущение, описание погоды и влажность воздуха) подставляются в текстовый шаблон. В итоге, в зависимости от данных, получается что-то вроде 

````
Ваш прогноз погоды ☄:

Сейчас температура составляет 22℃, но ощущается как 21℃ :)
На улице небольшой дождь,
влажность воздуха составляет 83%,
скорость ветра 6.7 м/c
````

- Всё, кроме [JsonParser](https://github.com/nlohmann/json "Тут ссылка на использованный мной модуль для парсига JSON"), написано мной в рамках работы над этим проктом

---
Процесс работы "сервера" (далее -- ядро):
- Данные (координаты или название города) от пользователя передаются клиентом в ядро.
- Если это название города: 
    - Запрос сначала улетает в на апи https://opencagedata.com/, которое возращает список городов, которые удалось найти.
    - Далее, вызывается callback у клиента (он должен реализовывать интерфейс принятия массива найденных городов и ответа номером города), где решается, какой город из списка выбрать.
    - После принятия клиентом решения о выборе города - необходимые координаты перенаправляются в выдачу ответа ядра по координатам (ниже) 
- Если это координаты, или у нас уже есть координаты из предыдущего шага:
    - Отправляем их на апи http://openweathermap.org, оно говорит нам данные о погоде
    - Погоду используем для формирования ответа (процесс формирования описан выше)

---
Как это запустить:

1) Добавить в корень проекта токены для api.openweathermap.org и api.opencagedata.com, в файлы WeatherToken.api и CitiesToken.api соответственно
2) `docker build -t smart-weather-service -f Dockerfile.dockerfile .`
3) `docker run -it smart-weather-service`

Если вы не хотите ставить докер (это просто, поверьте) - [есть возможность собрать всё вручную](ManualBuild.md "ссылка на инструкцию")

_p.s. Если нужны токены -- напишите в телеграм @shnurd6, я скину)_